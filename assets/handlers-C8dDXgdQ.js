import{a as p,i as m}from"./vendor-Cbhu4xvy.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function e(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(s){if(s.ep)return;s.ep=!0;const c=e(s);fetch(s.href,c)}})();const n={searchForm:document.querySelector(".search-form"),searchBtnClear:document.querySelector(".js-btn-clear"),categoriesList:document.querySelector(".categories"),productsList:document.querySelector(".products"),loadMoreButton:document.querySelector(".js-load-more-button"),notFoundDiv:document.querySelector(".not-found"),modalWindow:document.querySelector(".js-modal-window"),modalBackdrop:document.querySelector(".js-modal-backdrop"),closeButton:document.querySelector(".js-modal-close-button"),modalProductContainer:document.querySelector(".js-modal-product"),dataWishlistCount:document.querySelector("[data-wishlist-count]"),dataCardCount:document.querySelector("[data-cart-count]"),cardTotalItems:document.querySelector(".js-cart-total-items"),cardTotalPrice:document.querySelector(".js-cart-total-price"),cardBuyProductsButton:document.querySelector(".js-buy-products"),backToTopButton:document.querySelector(".js-back-to-top")},d={WISH_LIST_STORAGE_KEY:"wishlist",CARD_LIST_STORAGE_KEY:"cart",USER_VALUE_SESSION_STORAGE_KEY:"user-value-key"},a={category:null,currentPage:1,totalProducts:null,productsPerPage:12,searchQuery:null};p.defaults.baseURL="https://dummyjson.com/products/";async function q(){return(await p.get("category-list")).data}async function h(){const o=`?limit=12&skip=${(a.currentPage-1)*a.productsPerPage}`,e=await p.get(o);return a.totalProducts=e.data.total,e.data.products}async function T(t){const o=(a.currentPage-1)*a.productsPerPage,e=`category/${t}?limit=12&skip=${o}`,r=await p.get(e);return a.totalProducts=r.data.total,r.data.products}async function f(t){const o=`${t}`;return(await p.get(o)).data}async function j(t){const o=`search?q=${t}`;return(await p.get(o)).data.products}function D(t){t.unshift("all");const o=t.map(e=>`<li class="categories__item">
            <button class="categories__btn" type="button">${e}</button>
        </li>`).join("");n.categoriesList.innerHTML=o}function L(t){const o=t.map(({id:e,thumbnail:r,title:s,brand:c,category:i,price:l})=>`
    <li class="products__item" data-id="${e}">
       <img class="products__image" src="${r}" alt="${s}" />
       <p class="products__title">${s}</p>
       <p class="products__brand">
         <span class="products__brand--bold">Brand: ${c}</span>
       </p>
       <p class="products__category">Category: ${i}</p>
       <p class="products__price">Price: ${l}$</p>
    </li>`).join("");n.productsList.insertAdjacentHTML("beforeend",o)}function w(t){const o=t.map(({id:e,thumbnail:r,title:s,brand:c,category:i,price:l})=>`
    <li class="products__item" data-id="${e}">
       <img class="products__image" src="${r}" alt="${s}" />
       <p class="products__title">${s}</p>
       <p class="products__brand">
         <span class="products__brand--bold">Brand: ${c}</span>
       </p>
       <p class="products__category">Category: ${i}</p>
       <p class="products__price">Price: ${l}$</p>
    </li>`).join("");n.productsList.innerHTML=o}function M(t){const o=t.map(({id:e,thumbnail:r,title:s,brand:c,category:i,price:l})=>`
    <li class="products__item" data-id="${e}">
       <img class="products__image" src="${r}" alt="${s}" />
       <p class="products__title">${s}</p>
       <p class="products__brand">
         <span class="products__brand--bold">Brand: ${c}</span>
       </p>
       <p class="products__category">Category: ${i}</p>
       <p class="products__price">Price: ${l}$</p>
    </li>`).join("");n.productsList.insertAdjacentHTML("beforeend",o)}function x(t){const{id:o,thumbnail:e,title:r,tags:s,description:c,shippingInformation:i,returnPolicy:l,price:k}=t;return`
    <img class="modal-product__img" src="${e}" alt="${r}"/>
      <div class="modal-product__content" data-id="${o}">
        <p class="modal-product__title">${r}</p>
         <ul class="modal-product__tags">
          ${s.map(R=>`<li>${R}</li>`).join("")}
        </ul>
        <p class="modal-product__description">${c}</p>
        <p class="modal-product__shipping-information">Shipping: ${i}</p>
        <p class="modal-product__return-policy">Return Policy: ${l}</p>
        <p class="modal-product__price">Price: ${k}$</p>
        <button class="modal-product__buy-btn" type="button">Buy</button>
      </div>`}function K(t){return t.map(({id:e,thumbnail:r,title:s,brand:c,category:i,price:l})=>`
    <li class="products__item" data-id="${e}">
       <img class="products__image" src="${r}" alt="${s}" />
       <p class="products__title">${s}</p>
       <p class="products__brand">
         <span class="products__brand--bold">Brand: ${c}</span>
       </p>
       <p class="products__category">Category: ${i}</p>
       <p class="products__price">Price: ${l}$</p>
    </li>`).join("")}function Y({id:t,thumbnail:o,title:e,brand:r,category:s,price:c}){return`<li class="products__item" data-id="${t}">
            <img class="products__image" src="${o}" alt="${e}" />
            <p class="products__title">${e}</p>
            <p class="products__brand">
              <span class="products__brand--bold">Brand: ${r}</span>
            </p>
            <p class="products__category">Category: ${s}</p>
            <p class="products__price">Price: ${c}$</p>
          </li>`}function G(t){const o=document.querySelector(".categories__btn--active");o&&o!==t.target&&o.classList.remove("categories__btn--active"),t.target.classList.add("categories__btn--active")}function $(){n.notFoundDiv.classList.add("not-found--visible")}function P(){n.notFoundDiv.classList.remove("not-found--visible")}function C(){n.loadMoreButton.classList.remove("hide")}function S(){const t=document.querySelector(".js-load-more-button");t&&t.classList.add("hide")}function b(t,o){const e=JSON.stringify(o);localStorage.setItem(t,e)}function u(t){const o=localStorage.getItem(t);try{const e=JSON.parse(o);return Array.isArray(e)?e:[]}catch{return[]}}function N(t,o){const e=JSON.stringify(o);sessionStorage.setItem(t,e)}function W(t){const o=sessionStorage.getItem(t);try{return JSON.parse(o)||""}catch{return""}}function F(){n.modalBackdrop.classList.add("modal--is-open"),n.closeButton.addEventListener("click",_),n.modalBackdrop.addEventListener("click",_),document.addEventListener("keydown",I),U(),V()}function _(t){(!t||t.target===n.modalBackdrop||t.target===n.closeButton)&&(n.modalBackdrop.classList.remove("modal--is-open"),n.closeButton.removeEventListener("click",_),n.modalBackdrop.removeEventListener("click",_),document.removeEventListener("keydown",I))}function I(t){t.key==="Escape"&&_()}async function Q(){g(),y(),E();const t=W(d.USER_VALUE_SESSION_STORAGE_KEY);try{const o=await q();if(D(o),t)H(t);else{const e=await h();L(e),C()}}catch(o){console.log(o)}}async function z(){g(),y(),E();let t=u(d.WISH_LIST_STORAGE_KEY)||[];try{const o=t.map(r=>f(r)),e=await Promise.all(o);L(e)}catch(o){console.log(o)}}async function X(){g(),y(),B(),O(),E();let t=u(d.CARD_LIST_STORAGE_KEY)||[];try{const o=t.map(r=>f(r)),e=await Promise.all(o);L(e)}catch(o){console.log(o)}}async function Z(t){if(a.currentPage=1,a.totalProducts=0,!t.target.classList.contains("categories__btn"))return;const o=t.target.textContent.trim().toLowerCase();a.category=o,G(t);try{let e=[];o==="all"?e=await h():e=await T(o),e.length===0&&(S(),$()),w(e),P(),a.totalProducts>a.productsPerPage?C():S()}catch(e){console.log(e)}}async function tt(){let t=[],o=0;a.currentPage+=1;try{a.category==="all"||!a.category?(t=await h(),o=a.totalProducts):(t=await T(a.category),o=a.totalProducts),M(t),a.currentPage*a.productsPerPage>=o?(S(),m.info({message:"No more products to load"})):C()}catch(e){console.log(e)}}async function ot(t){t.preventDefault();const e=t.target.elements.searchValue.value.trim();if(e){a.searchQuery=e;try{N(d.USER_VALUE_SESSION_STORAGE_KEY,e),window.location.href="./index.html"}catch(r){m.error({message:"Something went wrong. Please, try later"}),console.log("Error in onSearchFormSubmit:",r)}}}async function H(t){try{const o=await j(t),e=K(o);n.productsList.innerHTML=e,e?P():$(),S(),sessionStorage.removeItem(d.USER_VALUE_SESSION_STORAGE_KEY)}catch(o){m.error({message:"Something went wrong. Please, try later"}),console.log("Error during search:",o)}}async function et(t){const o=t.target.closest(".products__item");if(!o)return;const e=o.dataset.id;try{const r=await f(e),s=x(r);n.modalProductContainer.innerHTML=s,F()}catch(r){m.error({message:"Something went to wrong. Please, try later"}),console.log(r)}}async function rt(t){const e=t.target.closest(".search-form").elements.searchValue;e.value="";try{window.location.href="./index.html";const r=await h();w(r),P()}catch(r){m.error({message:"Something went wrong. Please, try later"}),console.log("Error in onSearchFormSubmit:",r)}}function st(){const t=document.querySelector(".modal-product__content");if(!t)return;const o=t.dataset.id;let e=u(d.WISH_LIST_STORAGE_KEY);const r=document.querySelector(".js-wishlist-button");if(!r)return;const s=window.location.pathname.includes("/wishlist"),c=e.indexOf(o);c===-1?(e.push(o),r.textContent="Remove from wishlist",s&&A(o)):(e.splice(c,1),r.textContent="Add to wishlist",s&&v(o)),b(d.WISH_LIST_STORAGE_KEY,e),g()}function v(t){const o=document.querySelector(`.products__item[data-id="${t}"]`);o&&o.remove()}async function A(t){if(document.querySelector(".modal-product__content"))try{const e=await f(t);if(!e){console.error("Product not found");return}const r=Y(e);n&&n.productsList?n.productsList.insertAdjacentHTML("afterbegin",r):console.error("Products list container not found")}catch(e){console.log(e)}}function U(){const t=document.querySelector(".modal-product__content");if(!t)return;const o=t.dataset.id;let e=u(d.WISH_LIST_STORAGE_KEY);const r=document.querySelector(".js-wishlist-button");r&&(r.textContent=e.includes(o)?"Remove from Wishlist":"Add to Wishlist",g())}function g(){const t=u(d.WISH_LIST_STORAGE_KEY);n.dataWishlistCount?n.dataWishlistCount.textContent=t.length:console.error("refs.dataWishlistCount is not defined")}function ct(){const t=document.querySelector(".modal-product__content");if(!t)return;const o=t.dataset.id;let e=u(d.CARD_LIST_STORAGE_KEY);const r=document.querySelector(".js-card-button");if(!r)return;const s=window.location.pathname.includes("/cart"),c=e.indexOf(o);c===-1?(e.push(o),r.textContent="Remove from cart",s&&A(o)):(e.splice(c,1),r.textContent="Add to cart",s&&v(o)),b(d.CARD_LIST_STORAGE_KEY,e),y(),(n.cardTotalItems||n.cardTotalPrice)&&(B(),O())}function V(){const t=document.querySelector(".modal-product__content");if(!t)return;const o=t.dataset.id;let e=u(d.CARD_LIST_STORAGE_KEY);const r=document.querySelector(".js-card-button");r&&(r.textContent=e.includes(o)?"Remove from cart":"Add to cart",y())}function y(){const t=u(d.CARD_LIST_STORAGE_KEY);n.dataCardCount?n.dataCardCount.textContent=t.length:console.error("refs.dataCardCount is not defined")}function B(){const t=u(d.CARD_LIST_STORAGE_KEY);n.cardTotalItems?n.cardTotalItems.textContent=t.length:console.error("refs.cardTotalItems is not defined")}async function O(){const t=u(d.CARD_LIST_STORAGE_KEY);try{const o=t.map(c=>f(c)),r=(await Promise.all(o)).reduce((c,i)=>i.price?c+=i.price:c,0),s=n.cardTotalPrice;s.textContent=`$${r.toFixed(2)}`}catch(o){console.log(o)}}function nt(){m.success({message:"Success"})}function E(){const t=document.querySelector(".js-back-to-top");window.addEventListener("scroll",function(){window.scrollY>200?t.classList.add("show"):t.classList.remove("show")}),t.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})})}export{d as S,ot as a,rt as b,et as c,st as d,ct as e,nt as f,Q as g,Z as h,tt as i,X as j,W as l,z as o,H as p,n as r};
//# sourceMappingURL=handlers-C8dDXgdQ.js.map
